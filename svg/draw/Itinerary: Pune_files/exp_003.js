(function(f){YAHOO.namespace("expedia.container");var c={data:{},travelerCount:0,reset:function(){this.data={};this.travelerCount=0;},addTraveler:function(i,h,j){var g={travelerName:h,travelerCategory:j};this.data[i]=g;this.travelerCount++;},getTraveler:function(g){return this.data[g];},isInfantInLap:function(g){return this.getTraveler(g).travelerCategory=="infantinlap";}};var a={reset:function(){f("#selectedSeatsContainer").find("input[id^='seatPreference_']").val("");f("#selectedSeatsContainer").find("input[id^='isPreferredSeat_']").val("false");f("#selectedSeatsContainer").find("input[id^='isPreferenceGeneric_']").val("false");},updateValues:function(h,i){this.reset();var g=this;f.each(b.flights[i].flightArray,function(k,j){for(var l=1;l<=h;l++){var m=SEAT_SELECTOR.seatSelectionModel,n=m.getAssignedSeat(j.flightId,l);if(n!=m.constants.SEAT_UNASSIGNED){g.setValues(j,n,l);}}});},setValues:function(g,i,h){f("#seatPreference_"+g.flightId+"_T"+h).val(i.seatValue);f("#isPreferredSeat_"+g.flightId+"_T"+h).val(i.isPreferred);f("#isPreferenceGeneric_"+g.flightId+"_T"+h).val(i.isGeneric);}};var d={init:function(){var g=this;f("#seatMapPreviewLink, #seatMapChangeLink, .selected-seat-value-link, #seatMapPreviewLinkOnItin").bind("click",function(m){m.preventDefault();var i=((f("#seatMapPreviewLink").attr("data-seatmap-loaded")!="true")||(this.id=="seatMapPreviewLink"));var j=f(this).attr("data-travlerNo");var l=f(this).attr("data-flight");if(typeof(j)==="undefined"){j=1;}var k=f(this).attr("data-flightId");var h;if(typeof(k)==="undefined"){h=b.flights[l].resetToFirstFlight();}else{h={flightId:k};b.flights[l].setCurrentFlightAs(h);}g.updateTravelerModel(l);b.seatmapPanel.render(i,j,l);b.seatmapPanel.showSeatmapFor(h,j,l);});},updateTravelerModel:function(g){var l=f("#travelersCountInTrip").val();c.reset();for(var j=0;j<l;j++){var o=f("#tp_primary_contact_first_name_input_"+j).val(),h=f("#tp_primary_contact_middle_name_input_"+j).val(),p=f("#tp_primary_contact_last_name_input_"+j).val(),q=f("#tp_name_fields_swapped").val();var n=o+" "+h+" "+p;if(q=="true"){n=p+" "+o;}n=f.trim(n);var m=j+1;var k=f("#passengerType_"+m).val();if(n==""){n=f("#seatMapText").attr("data-"+k);}c.addTraveler(m,n,k);f.each(b.flights[g].flightArray,function(r,i){f("#divSeatMapStaticContent_"+i.flightId).find("#travelerNameText_"+(j+1)).html(n);});}},onSeatmapClose:function(h){var g=f("#travelersCountInTrip").val();a.updateValues(g,h);this.updateView(g,h);f(".itinSeatSelectionMessage").hide();},updateView:function(h,i){var g=this;this.hidePreferredSeatLegend();f.each(b.flights[i].flightArray,function(k,j){g.updateSeatSelectionTextFor(j,h);});if(g.atLeastOneSeatSelected(h,i)){f("#seatSelectionOptions").hide();f("#selectedSeatsContainer").show();if(h>1){f("#seatMapChangeLink").show();f("#generic_seat_selection_container").hide();}}},updateSeatSelectionTextFor:function(g,j){for(var i=1;i<=j;i++){var k=SEAT_SELECTOR.seatSelectionModel.getAssignedSeat(g.flightId,i);var h=this.getSeatSelectionText(g.flightId,k,i);this.updateSeatSelectionText(g.flightId,i,h);}},updateSeatSelectionText:function(j,i,h){var g=f("#selectedSeatsContainer #selectedSeatValue_"+j+"_"+i+" a");g.html(h);},getSeatSelectionText:function(i,l,h){var j=SEAT_SELECTOR.seatSelectionModel;if(this.isInfantInLap(h)){return f("#seatMapText").attr("data-infantinlap-seatpref");}var k=f("#seatMapText").attr("data-no-seat-selected");var g=f("#flightSeatMapAjaxParam_"+i);if(g!==undefined){if(g.get(0).value.search("hideSeatPreferenceSelection=true")!=-1){return k;}}if(l!=j.constants.SEAT_UNASSIGNED){k=l.seatName;if(l.isGeneric){k=this.genericSeatSelectionTexts[l.seatValue];}if(l.isPreferred){k+="<span class='selectedSeatPreferred'>*</span>";this.showPreferredSeatLegend();}}return k;},isInfantInLap:function(h){var g=f("#passengerType_"+h).val();return g=="infantinlap";},hidePreferredSeatLegend:function(){f("#seat_preference_preferred_seating_legend_container").hide();},showPreferredSeatLegend:function(){f("#seat_preference_preferred_seating_legend_container").show();},atLeastOneSeatSelected:function(i,j){var g=false;var h=this;f.each(b.flights[j].flightArray,function(l,k){g=g||h.atLeastOneSeatSelectedForTravelersInFlight(k,i);});return g;},atLeastOneSeatSelectedForTravelersInFlight:function(g,i){for(var h=1;h<=i;h++){var j=SEAT_SELECTOR.seatSelectionModel,k=j.getAssignedSeat(g.flightId,h);if(this.hasUserChangedDefaultSeatSelection(j,k,h)){return true;}}return false;},hasUserChangedDefaultSeatSelection:function(h,i,g){if(this.isUnAssigned(h,i)){return false;}return i.seatName!=f("select#seatpreferenceID_traveler"+(g-1)+" option:selected").text();},isUnAssigned:function(g,h){return h==g.constants.SEAT_UNASSIGNED;},genericSeatSelectionTexts:{"0":f("#seatMapText").attr("data-no-seat-selected"),"1":f("#seatMapText").attr("data-window-seat-selected"),"3":f("#seatMapText").attr("data-aisle-seat-selected")}};var b={data:null,flights:{},callbackHandler:null,init:function(g){this.callbackHandler=g;this.initializeSeatMap();this.initializeSeatMapNavigator();},initializeSeatMap:function(){f.each(f("div.flightData"),function(g,h){var i=f(h).attr("data-flight");if(!b.flights[i]){b.flights[i]=new e(i);}b.flights[i].add({flightId:f(h).attr("data-id")});});},initializeSeatMapNavigator:function(){var g=this;f(".divSeatMapPopup #nextFlightButton").bind("click",function(i){i.preventDefault();var h=f(this).parents(".divSeatMapPopup").attr("data-flight");b.seatmapPanel.showSeatmapFor(b.flights[h].nextFlight(),1,h);});f(".divSeatMapPopup #prevFlightLink").bind("click",function(i){i.preventDefault();var h=f(this).parents(".divSeatMapPopup").attr("data-flight");b.seatmapPanel.showSeatmapFor(b.flights[h].prevFlight(),1,h);});f(".divSeatMapPopup #continueFlightButton, "+".divSeatMapPopup #seatmap-skip-selection, "+".divSeatMapPopup #seatmap-btn-close").bind("click",function(i){i.preventDefault();var h=f(this).parents(".divSeatMapPopup").attr("data-flight");YAHOO.expedia.container.seatMapPanel.hide();f(".mask").remove();g.onClose(h);});f(".divSeatMapPopup .box .btn-close").bind("click",function(h){h.preventDefault();f(this).closest(".box").hide();});},onClose:function(g){this.callbackHandler.onSeatmapClose(g);},seatmapPanel:{populateTravelerName:function(h){for(var g=0;g<c.travelerCount;g++){f.each(b.flights[h].flightArray,function(j,i){var k=(g+1);f("#divSeatMapStaticContent_"+i.flightId).find("#travelerNameText_"+k).html(c.getTraveler(k).travelerName);});}},applyFixForIE6AndBackwards:function(){YAHOO.expedia.container.seatMapPanel.beforeShowEvent.subscribe(function(){var h=document.getElementsByTagName("select");for(var g=0;h[g];g+=1){if(h[g].className==="leftDrop"){h[g].disabled="disabled";}}},YAHOO.expedia.container.seatMapPanel,true);YAHOO.expedia.container.seatMapPanel.beforeHideEvent.subscribe(function(){var h=document.getElementsByTagName("select");for(var g=0;h[g];g+=1){if(h[g].className==="leftDrop"){h[g].disabled="";}}},YAHOO.expedia.container.seatMapPanel,true);},render:function(g,j,k){var h=this;k=k||"";var i="divSeatMapPopup_"+k;this.populateTravelerName(k);YAHOO.expedia.container.seatMapPanel=new YAHOO.widget.Panel(i,{width:"810px",constraintoviewport:true,underlay:"shadow",modal:true,draggable:false,close:false});YAHOO.expedia.container.seatMapPanel.showEvent.subscribe(function(){f("#"+i).show();f("#"+i).find(".flight-box").first().show();if(g==true){b.seatMapDataProvider.populateSeatMapData(j,k);}},YAHOO.expedia.container.seatMapPanel,true);if(YAHOO.env.ua.ie&&(YAHOO.env.ua.ie<7)){this.applyFixForIE6AndBackwards();}YAHOO.expedia.container.seatMapPanel.render();f("#"+i+"_mask").after(f("#"+i+"_c"));YAHOO.expedia.container.seatMapPanel.center();YAHOO.expedia.container.seatMapPanel.show();YAHOO.expedia.container.seatMapPanel.focusFirst();},updateNavigationButtonStates:function(l){var i=function(){f("#nextFlightButton").hide();f("#continueFlightButton").addClass("showContinueButton");f("#itinSeatPrefSubmitButton").addClass("showItinSeatPrefSubmitButton");};
var k=function(){f("#prevFlightLink").removeClass("disabled");f("#prevFlightLink").removeAttr("tabindex");};var h=function(){f("#prevFlightLink").addClass("disabled");f("#prevFlightLink").attr("tabindex","-1");};var g=function(){f("#prevFlightLink").hide().next("span").hide();};var j=function(){f("#nextFlightButton").show();f("#continueFlightButton").removeClass("showContinueButton");f("#itinSeatPrefSubmitButton").removeClass("showItinSeatPrefSubmitButton");};if(b.flights[l].isTripMultiFlight()){if(b.flights[l].isCurrentFlightTheFirst()){j();h();}else{if(b.flights[l].isCurrentFlightTheLast()){i();k();}else{j();k();}}}else{i();g();}},showSeatmapFor:function(g,h,i){var j=f("#divSeatMapStaticContent_"+g.flightId);i=i||"";j.parent().find(".flight-box").hide();j.show();this.updateNavigationButtonStates(i);f("#divSeatMapPopup_"+i).trigger("switchFlight.seatAssigner",{flightId:g.flightId,travelerNo:h});}},seatMapDataProvider:{sUrl:f("#flightSeatMapAjaxUrl").val(),populateSeatMapData:function(h,i){var g=this;SEAT_SELECTOR.seatSelectionModel.init();f.each(b.flights[i].flightArray,function(j,k){if(f("#seatMapPreviewLink").attr("data-seatmap-loaded")!="true"){g.getData({flightId:k.flightId,flightUniqueID:i,travelerNo:h,successCallback:f.proxy(g.handleSuccess,g),errorCallback:f.proxy(g.handleError,g)});}else{g.initSeatAssigner(k.flightId,h,i);}});f("#seatMapPreviewLink").attr({"data-seatmap-loaded":"true"});},reportOmniture:function(h){s_exp=s_gi(s_account);s_exp.linkTrackVars="channel,prop11,prop12,pageName,events,eVar25,prop25,prop36,eVar26,prop26";s_exp.linkTrackEvents="event38";s_exp.prop11=tuid;s_exp.prop12=guid;s_exp.channel="CKO";s_exp.pageName="page."+f("#productType").val()+".Checkout.Seats";s_exp.events="";s_exp.prop36="";productType=f("#productType").val()=="Package"?"PKG":"FLT";var g=f("#divSeatMapStaticContent_"+h).find("#seatMapOmnitureMsg");if(g.length>0){s_exp.events="event38";s_exp.prop36=productType+":"+g.val();}s_exp.eVar25="Shopper";s_exp.prop25=s_exp.eVar25;s_exp.eVar26=productType+" Shopper";s_exp.prop26=s_exp.eVar26;s_exp.tl(this,"o","Select Seat");},handleSuccess:function(i,j,h,k){var g=f("#divSeatMapStaticContent_"+j);g.find("#divSeatMapPreview").html(i);this.switchSeatMapLegend(g);this.switchSeatGuruLegend(g);this.initSeatAssigner(j,h,k);this.reportOmniture(j);},initSeatAssigner:function(i,h,j){var g=f("#divSeatMapStaticContent_"+i);f("#divSeatMapPopup_"+j).trigger("init.seatAssigner",[g,i,h]);},switchSeatGuruLegend:function(h){var g=(h.find("#divPlaneSeatGuruFlag").size()>0)&&(h.find("#divPlaneSeatGuruFlag").first().css("display")=="block");if(h.find("#divSeatGuruLegend").length>0){if(g){h.find("#divSeatGuruLegend").show();h.find("#divSeatDesc").show();h.find("#seatguruMessage").show();}else{h.find("#divSeatGuruLegend").hide();h.find("#divSeatDesc").hide();}}},switchSeatMapLegend:function(g){var h=g.find("#seatmapGenericPrefeference");if(h.length){g.find("#legend").hide();}},handleError:function(i,h,j){var g=f("#divSeatMapStaticContent_"+i);g.find("#divSeatMapPreview").html(f("#divSeatMapErrorResponse").html());this.switchSeatMapLegend(g);this.initSeatAssigner(i);},getData:function(i){var h=this,g=f("#flightSeatMapAjaxParam_"+i.flightId).val(),j=i.flightUniqueID||"";f.ajax({url:h.sUrl,data:g,success:function(k){i.successCallback(k,i.flightId,i.travelerNo,j);},error:function(){i.errorCallback(i.flightId,i.travelerNo,j);}});}}};function e(g){this.currentIndex=0;this.flightArray=new Array();this.uniqueID=g;this.add=function(h){this.flightArray.push(h);};this.resetToFirstFlight=function(){this.currentIndex=0;return this.flightArray[0];};this.nextFlight=function(){var h=this.currentIndex+1;if(h<this.flightArray.length){this.currentIndex=h;}return this.flightArray[this.currentIndex];};this.prevFlight=function(){var h=this.currentIndex-1;if(h>=0){this.currentIndex=h;}return this.flightArray[this.currentIndex];};this.isCurrentFlightTheFirst=function(){return(this.currentIndex==0);};this.isCurrentFlightTheLast=function(){return(this.currentIndex==(this.flightArray.length-1));};this.isTripMultiFlight=function(){return(this.flightArray.length>1);};this.setCurrentFlightAs=function(i){var h=this;f.each(b.flights[h.uniqueID].flightArray,function(k,j){if(j.flightId==i.flightId){h.currentIndex=k;return j;}});};}f(document).ready(function(){d.init();b.init(d);f("[id*=itinSeatPrefSubmitButton]").click(function(){var i=f(this).parents(".divSeatMapPopup").attr("data-flight");b.onClose(i);var h=f("#travelersCountInTrip").val();var g=false;f.each(b.flights[i].flightArray,function(k,j){for(var l=1;l<=h;l++){var m=SEAT_SELECTOR.seatSelectionModel,n=m.getAssignedSeat(j.flightId,l);if(n!=m.constants.SEAT_UNASSIGNED&&!n.isGeneric){g=true;}}});if(!g){f(".itinSeatSelectionMessage").show();return false;}f.each(b.flights[i].flightArray,function(l,j){for(var m=1;m<=h;m++){var o=SEAT_SELECTOR.seatSelectionModel,q=o.getAssignedSeat(j.flightId,m);var p=f("#divSeatMapStaticContent_"+j.flightId).find("#travelerAction_"+m).find("h5");var n=p.attr("data-assigned-seat");if(q==o.constants.SEAT_UNASSIGNED&&n!=null&&n!=""){var k={seatName:n,seatValue:n,isPreferred:false,isPreferredSeatSelectionConfirmed:false,isGeneric:false};a.setValues(j,k,m);}}});f("#trip_preferences_form.trip_preferences_form_"+i).submit();return false;});});})(jQuery);
/*!  generated on 2015-09-17 19:49:11.082 PDT(-0700) in 2 ms  */

/*!  served in 2 ms  */
